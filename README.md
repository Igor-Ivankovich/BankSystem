# BankSystem
Приложение написано с использование консольного ввода/вывода.

Запуск приложения производится с помощью команды:
```
ruby bank_system.rb 
```

Все приложения написано без использования ООП, каждый функциональный блок которого разделен каждый в отдельный файлй:
```
create_user.rb              - Создание пользователя.
opening_account.rb          - Открытие счета для пользователя.
adding_funds.rb             - Пополнение счета.
transfer_funds.rb           - Перевод между счетами.
reports.rb                  - Отчеты "О сумме пополнений за период времени по-валютно"
                                     "Средняя, максимальная и минимальная сумма переводов по тегам пользователей за период времени" 
                                     "Сумма всех счетов на текущий момент времени повалютно"
```


Для ввода и вывода в основном испольуется функционал:
```
 gem tty-prompt
```

Данный функционал выведен в отдельный файл **cli_ask.rb**, где разделен на типы вводимых данных.

Для сохранения данных используется **sqlite**

Функционал создания таблиц находится в файле  **db_tables.rb**
Построение таблиц:
```
ruby db_tables.rb 
```

Тестовая база **test.db**

Основная часть констант вынесена в отдельный файл **bank_constant.rb**

Часть валидации, выведена в отдельный файл  **validation.rb**
 

# **Функционал**

Основная логика оброботки:
```
create_user.rb              - Создание пользователя.
opening_account.rb          - Открытие счета для пользователя.
adding_funds.rb             - Пополнение счета.
transfer_funds.rb           - Перевод между счетами.
```

Была вынесена в отдельную функцию **get_attribute** находящуюся в файле **bank_system.rb**

**На вход она получает:**
```
     db                      -      открытый поток базы
     validation_function     -      функция в которой будет проверятся валидность данных
     type                    -      тип значения для ввода
     number                  -      индификационный номер пользователя(при необходимости)
     function                -      дополнительная функция, которая необходима при условии невалидности данных
```
**На выходе:**
Получаем введенные валидные данные

**Логика следующая:**
Функционал построен на бесконечном цикле, он будет работать до того момента, пока пользователь не введет валидные данные.


**Функционал репортов:**
Построен на логике добавления необходимых параметров к шаблону **SQL**, если пользователь ввел интересующей параметр.

Вывод может производится как в  **csv** файл так и в консоль - по желанию пользователя.


Все тесты находятся в папке spec:
```
adding_funds_spec.rb                   - тесты по функционалу: пополнение счета.
create_user_spec.rb                    - тесты по функционалу: создание пользователя.
transfer_funds_spec.rb                 - тесты по функционалу: перевод между счетами.
opening_account_spec.rb                - тесты по открытие счета для пользователя.
report_account_sum_spec.rb             - тесты по отчету "Сумма всех счетов на текущий момент времени повалютно"
report_adding_founds_spec.rb           - тесты по отчету "О сумме пополнений за период времени по-валютно"
report_transfer_founds_spec.rb         - тесты по отчету "Средняя, максимальная и минимальная сумма переводов по тегам пользователей за период времени" 
```

Логика тестов построена на внедренее во входной поток, передаваймых параметров таким образом, чтобы тесты не упали.
Также в некоторых тестах используется создание записей для проверки функционала.
